阶段一：库存预热 
    1、查询秒杀的商品，
    2、写入Redis缓存中（key商品id  value 库存数量）
        ↓
阶段二：用户秒杀阶段
3、用户点击"立即抢购"
        ↓
Lua脚本原子扣减Redis库存
Redis执行Lua脚本：
1. 读取库存：GET seckill:stock:1 → 10000（通过缓存key 商品id获取库存数量）
2. 判断库存：10000 >= 1？是（判断库存是否大于等于1）
3. 扣减库存：DECRBY seckill:stock:1 1 → 9999
4. 返回剩余库存：9999
        ↓
标记用户已秒杀(将用户id作为key value 库存数放到redis缓存)
        ↓
发送RocketMQ消息（削峰、异步、解耦）   
调用rocketMQTemplate的发送方法，里传两个参数，一个是路由键，一个是消息体(里是用户id、商品id、数量)
        ↓
返回"秒杀成功"
        ↓
Consumer接收到消息后，开始异步处理秒杀订单
        ↓
  扣减库存（乐观锁）
         ↓
    创建订单 
        ↓
  记录库存日志 
        ↓ 
  记录用户秒杀记录



### 防超卖的3道防线
1. **Redis Lua脚本**（第6步）：原子操作，绝对不超卖
2. **MySQL乐观锁**（第8步）：version字段，防止并发更新
3. **库存日志**（第8步）：记录每次扣减，方便排查问题

### 防重复秒杀的2道防线
1. **Redis防线**（第6步）：seckill:user:{userId}:{productId}，秒杀前检查
2. **MySQL防线**（第8步）：tb_user_seckill表，唯一索引uk_user_product